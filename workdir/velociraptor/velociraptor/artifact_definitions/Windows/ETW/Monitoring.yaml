name: Windows.ETW.Monitoring
description: |
  This artifact contains

  This artifact was built on 2025-08-19T21:35:41Z

type: CLIENT_EVENT

parameters:
  - name: RuleLevel
    type: choices
    default: All
    choices:
      - "Critical"
      - "Critical and High"
      - "Critical, High, and Medium"
      - "All"

  - name: RuleStatus
    type: choices
    default: All Rules
    choices:
      - Stable
      - Stable and Experimental
      - Stable and Test
      - All Rules

  - name: RuleTitleFilter
    type: regex
    default: .
    description: Use this to filter only some rules to match

  - name: RuleExclusions
    type: csv
    description: |
      Some rules in the Hayabusa set are extremely noisy, so they
      are disabled by default.
    default: |
      RuleTitleRegex,Reason
      Proc Exec,Fires on every Process Execution EID 1
      File Created,Fires on every Sysmon EID 11
      Reg Key Value Set,Fires on every Sysmon EID 13
      DNS Query,Fires on every Sysmon EID 22
      Proc Terminated$,Fires on every Sysmon EID 5
      Proc Injection$,Fires on every Sysmon EID 8
      Reg Key Create/Delete,Fires on every Sysmon EID 12
      WMI Provider Started,Fires on every Microsoft-Windows-WMI-Activity/Operational EID 5857
      noisy,All rules marked noisy should be disabled by default.

  - name: DateAfter
    description: "search for events after this date. YYYY-MM-DDTmm:hh:ss Z"
    type: timestamp

  - name: DateBefore
    description: "search for events before this date. YYYY-MM-DDTmm:hh:ss Z"
    type: timestamp

imports:
  - Windows.Sigma.ETWBase
export: |
     LET SigmaRules <= gunzip(string=base64decode(string="H4sIAAAAAAAA/9STz2rbQBDG7/sUc6igpdiF5KZbcJ0SUichCjWFpWG9O1YWj3bN7kiyoA9ftFJUuw0lh/bQm2d2/nzz/Sy2TJjDIqBBx1ZRBKU1xgjb4CvYKL2r9xEaq+C+dobo/EyQL6Ovg8ZcAGjFWPrQ5YDcCoB98KbWnENrnfFtFAARQ2M15rDD4JCEQUbN1rvU752xKYC3yO3jPvi0XjkD4+9HpypMCe2rSjlD1uG71DuF/SiAxZD4bB1+D2MOYAbX98WTb6+xW5VhSu6wq8owN0QC4Gj10LZs0PFDt8cc7oZ8wSrwcOGkaqgdC25UldZCGJ2a4wEFYYOUg8Gtqon745WlOE2F7Kg7A1K1009oIDu6JRNiNpuJ31iBsVH7BkOXAH3pFywqM6z97yB9IBtZBzQxXw+yjv+WL5bh5peSP2FcBFSMo9uv4nhq6N/meGkJnz829lBcrMAoVhsV/yG9iDQ8JFTOM+BBUx2tdz2sKTgxZHk4JfVtnkt5F3wZVJXOiFKePo4ApSy6yFidn0lJUcWYnOzl0k95kEZMps/fr69uPt6uCymLr8XDctU3L25vLq8+SVlcrN68zLWf8WpGywNmo/VoYNuDyJ5FZOJHAAAA///3F5UJFAUAAA=="))
sources:
- query: |
    SELECT *
    FROM Artifact.Windows.Sigma.ETWBase(
       RuleLevel=RuleLevel, RuleStatus=RuleStatus,
       RuleTitleFilter=RuleTitleFilter, RuleExclusions=RuleExclusions,
       SigmaRules=SigmaRules)
