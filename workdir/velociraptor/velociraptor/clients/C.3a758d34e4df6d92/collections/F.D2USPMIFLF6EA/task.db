
Ú1
F.D2USPMIFLF6EAÒÃ1
ŠX
VLET Interfaces = SELECT HardwareAddrString AS MAC FROM interfaces() WHERE HardwareAddr†
ƒLET Generic_Client_Info_BasicInformation_0_1 = SELECT config.Version.Name AS Name, config.Version.BuildTime AS BuildTime, config.Version.Version AS Version, config.Version.ci_build_url AS build_url, config.Version.install_time AS install_time, config.Labels AS Labels, Hostname, OS, Architecture, Platform, PlatformVersion, KernelVersion, Fqdn, Interfaces.MAC AS MACAddresses FROM info()›
6SELECT * FROM Generic_Client_Info_BasicInformation_0_1a$74b898ea2b289167de0e57ca3eaca59089f7c51b1805ab33130fa1d053220dbc21129ff470beef9bcc318d0fa87e4ba7 è€ˆ
³!
LET Info = SELECT * FROM info()k
iLET Generic_Client_Info_DetailedInfo_0_1 = SELECT _key AS Param, _value AS Value FROM items(item=Info[0])—
2SELECT * FROM Generic_Client_Info_DetailedInfo_0_1a$74b898ea2b289167de0e57ca3eaca5900fbf2c674e4731d25b389d9d52a25f6f73e23c61d6b37d1d46a67c83d1461351 è€ˆ
Ü]
[LET precondition_Generic_Client_Info_LinuxInfo_0 = SELECT OS FROM info() WHERE OS = 'linux'«
¨LET Generic_Client_Info_LinuxInfo_0_0 = SELECT if(condition=version(function='sysinfo') != NULL, then=sysinfo()) AS `Computer Info`, { SELECT Name, HardwareAddrString AS MACAddress, Up, PointToPoint, AddrsString AS IPAddresses FROM interfaces() WHERE HardwareAddr } AS `Network Info` FROM scope()˜
ÒSELECT * FROM if(then=Generic_Client_Info_LinuxInfo_0_0, condition=precondition_Generic_Client_Info_LinuxInfo_0, else={ SELECT * FROM scope() WHERE log(message='Query skipped due to precondition')  AND FALSE })A$74b898ea2b289167de0e57ca3eaca590045deed56d1c97e4648dde9267775d86 èê(SELECT OS From info() where OS = 'linux'€ˆ
ƒ
a
_LET precondition_Generic_Client_Info_WindowsInfo_0 = SELECT OS FROM info() WHERE OS = 'windows'Â
¿LET DomainLookup <= dict(`0`='Standalone Workstation', `1`='Member Workstation', `2`='Standalone Server', `3`='Member Server', `4`='Backup Domain Controller', `5`='Primary Domain Controller')ƒ
€LET Generic_Client_Info_WindowsInfo_0_1 = SELECT { SELECT DNSHostName, Name, Domain, TotalPhysicalMemory, get(item=DomainLookup, field=str(str=DomainRole), default="Unknown") AS DomainRole FROM wmi(query='SELECT * FROM win32_computersystem') } AS `Computer Info`, { SELECT Caption, join(array=IPAddress, sep=", ") AS IPAddresses, join(array=IPSubnet, sep=", ") AS IPSubnet, MACAddress, join(array=DefaultIPGateway, sep=", ") AS DefaultIPGateway, DNSHostName, join(array=DNSServerSearchOrder, sep=", ") AS DNSServerSearchOrder FROM wmi(query="SELECT * from Win32_NetworkAdapterConfiguration") WHERE IPAddress } AS `Network Info` FROM scope()œ
ÖSELECT * FROM if(then=Generic_Client_Info_WindowsInfo_0_1, condition=precondition_Generic_Client_Info_WindowsInfo_0, else={ SELECT * FROM scope() WHERE log(message='Query skipped due to precondition')  AND FALSE })A$74b898ea2b289167de0e57ca3eaca59042de53e30aff4454ffde0a28ae686342 èê*SELECT OS From info() where OS = 'windows'€ˆ
•[
YLET precondition_Generic_Client_Info_Users_0 = SELECT OS FROM info() WHERE OS = 'windows't
rLET Generic_Client_Info_Users_0_0 = SELECT Name, Description, Mtime AS LastLogin FROM Artifact.Windows.Sys.Users()
ÊSELECT * FROM if(then=Generic_Client_Info_Users_0_0, condition=precondition_Generic_Client_Info_Users_0, else={ SELECT * FROM scope() WHERE log(message='Query skipped due to precondition')  AND FALSE })A$74b898ea2b289167de0e57ca3eaca5908eccc588ca7ea22cef17e81ea99a18d9 è*‰
Windows.Sys.AllUsers]
remoteRegKeyMHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\*"ü
*SELECT OS FROM info() WHERE OS = 'windows'eLET GetTimestamp(High, Low) = if(condition=High, then=timestamp(winfiletime=High * 4294967296 + Low))LET roaming_users <= SELECT split(string=Key.OSPath.Basename, sep="-")[-1] AS Uid, "" AS Gid, LookupSIDCache(SID=Key.OSPath.Basename || "") AS Name, Key.OSPath AS Description, ProfileImagePath AS Directory, Key.OSPath.Basename AS UUID, Key.Mtime AS Mtime, { SELECT Mtime FROM stat(filename=expand(path=ProfileImagePath)) } AS HomedirMtime, dict(ProfileLoadTime=GetTimestamp(High=LocalProfileLoadTimeHigh, Low=LocalProfileLoadTimeLow), ProfileUnloadTime=GetTimestamp(High=LocalProfileUnloadTimeHigh, Low=LocalProfileUnloadTimeLow), ProfileImagePath=ProfileImagePath, ProfileKey=Key.OSPath) AS Data FROM read_reg_key(globs=remoteRegKey, accessor="registry")DLET roaming_users_lookup <= memoize(query=roaming_users, key="UUID")ÈLET local_users <= SELECT User_id AS Uid, Primary_group_id AS Gid, Name, Comment AS Description, get(item=roaming_users_lookup, field=User_sid) AS RoamingData, User_sid AS UUID FROM users() LIMIT 1000ULET local_users_lookup <= memoize(query={ SELECT UUID FROM local_users }, key="UUID")äLET local_users_with_mtime = SELECT Uid, Gid, Name, Description, RoamingData.Directory AS Directory, UUID, RoamingData.Mtime AS Mtime, RoamingData.HomedirMtime AS HomedirMtime, RoamingData.Data || dict() AS Data FROM local_users…SELECT * FROM chain(q1=local_users_with_mtime, q2={ SELECT * FROM roaming_users WHERE NOT get(item=local_users_lookup, field=UUID) })Rclient’‰LET LookupSIDCache(SID) = cache(name="SID", key=SID, func=lookupSID(sid=SID) || pathspec(parse=stat(accessor="registry", filename="HKEY_LOCAL_MACHINE/Software/Microsoft/Windows NT/CurrentVersion/ProfileList/" + SID + "/ProfileImagePath").Data.value).Basename || "")*ê
Windows.Sys.Users]
remoteRegKeyMHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\*"Ö
*SELECT OS FROM info() WHERE OS = 'windows'eLET GetTimestamp(High, Low) = if(condition=High, then=timestamp(winfiletime=High * 4294967296 + Low))ÀSELECT split(string=Key.OSPath.Basename, sep="-")[-1] AS Uid, "" AS Gid, LookupSIDCache(SID=Key.OSPath.Basename || "") AS Name, Key.OSPath AS Description, ProfileImagePath AS Directory, Key.OSPath.Basename AS UUID, Key.Mtime AS Mtime, { SELECT Mtime FROM stat(filename=expand(path=ProfileImagePath)) } AS HomedirMtime, dict(ProfileLoadTime=GetTimestamp(High=LocalProfileLoadTimeHigh, Low=LocalProfileLoadTimeLow), ProfileUnloadTime=GetTimestamp(High=LocalProfileUnloadTimeHigh, Low=LocalProfileUnloadTimeLow)) AS Data FROM read_reg_key(globs=remoteRegKey, accessor="registry")RclientŠWindows.Sys.AllUsersê*SELECT OS From info() where OS = 'windows'€ˆÐ